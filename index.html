<!DOCTYPE html>
<html lang="es">
<head>
    <!-- NOTA: <base target="_top"> no es necesario ni funcional en el entorno de Canvas.
               Se mantiene por si se copia de nuevo para Apps Script. -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consola WOM Venta - Experiencia Premium</title>
    <!-- Font Awesome para una iconografía elegante y moderna -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /*
         * Variables CSS: La paleta de colores y las propiedades de diseño
         * están inspiradas en la estética de WOM, pero refinadas para un look neumórfico
         * más profundo y sofisticado, con un contraste óptimo y un toque premium.
         */
        :root {
            --bg-color: #2A004F; /* Púrpura oscuro para el fondo y elementos principales */
            --primary-accent: #FF00FF; /* Fucsia vibrante para el brillo principal (WOM) */
            --secondary-accent: #A000A0; /* Un fucsia-magenta ligeramente más oscuro para acentos sutiles */
            --tertiary-accent: #00FFFF; /* Cian vibrante para un contraste dinámico */
            --light-shadow: #380060; /* Sombra clara para el efecto neumórfico (arriba-izquierda) */
            --dark-shadow: #1A002F; /* Sombra oscura para el efecto neumórfico (abajo-derecha) */
            --text-light: #FFFFFF; /* Texto principal blanco para máxima legibilidad */
            --text-dark: #E0E0E0; /* Texto secundario ligeramente grisáceo, aún brillante */
            --border-radius-lg: 32px; /* Radio de borde grande para contenedores principales */
            --border-radius-md: 20px; /* Radio de borde medio para botones/tarjetas */
            --status-bar-height: 0px; /* Altura de la barra de estado ahora es 0 */
            --nav-bar-height: 75px;
            --message-box-success: #4CAF50; /* Verde para mensajes de éxito */
            --message-box-error: #F44336; /* Rojo para mensajes de error */
            --message-box-info: #2196F3; /* Azul para mensajes de información */

            /* Nuevas variables para el estilo de modal de la imagen (glassmorphism) */
            /* Ajustados a RGBA para mayor transparencia en el contenido del modal */
            --modal-bg-gradient-start: rgba(58, 0, 111, 0.85); /* Púrpura más claro con 85% de opacidad */
            --modal-bg-gradient-end: rgba(106, 0, 160, 0.85); /* Púrpura más intenso con 85% de opacidad */
            --modal-input-border: #8A00C0; /* Borde de input más claro */
            --modal-input-text: #E0E0E0; /* Color de texto para inputs */
            --modal-button-gradient-start: #FF00FF; /* Fucsia para el inicio del botón */
            --modal-button-gradient-end: #8A00C0; /* Púrpura para el final del botón */
            --modal-text-color: #FFFFFF; /* Color de texto general del modal */
            --modal-link-color: #00FFFF; /* Cian para enlaces (ej. Forgot Password) */
        }

        /*
         * Reset básico y tipografía fluida.
         * La fuente 'Inter' es limpia y moderna, ideal para interfaces.
         * Se utiliza `clamp()` para asegurar un tamaño de fuente responsivo y legible.
         */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-color); /* Fondo base */
            color: var(--text-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            overflow: hidden; /* Evita barras de desplazamiento en el cuerpo */
            /* Sutil gradiente radial para añadir profundidad al fondo, creando un "escenario" para el neumorfismo */
            background: radial-gradient(circle at 50% 50%, #350065 0%, var(--bg-color) 100%);
        }

        /*
         * Contenedor principal que ahora ocupa toda la pantalla, sin simular un marco de dispositivo.
         * Se eliminan los bordes redondeados y sombras que daban el aspecto de "teléfono".
         */
        .app-frame {
            width: 100vw; /* Ocupa el 100% del ancho del viewport */
            height: 100vh; /* Ocupa el 100% del alto del viewport */
            background-color: var(--bg-color);
            border-radius: 0; /* Sin bordes redondeados para simular teléfono */
            box-shadow: none; /* Sin sombras para simular teléfono */
            overflow: hidden; /* Oculta el contenido fuera del marco */
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Transición suave para redimensionamiento */
        }

        /*
         * Barra de estado superior - AHORA OCULTA.
         */
        .status-bar {
            display: none; /* Oculta completamente la barra de estado */
            height: var(--status-bar-height); /* Esto será 0px */
            background-color: var(--bg-color);
            justify-content: space-between;
            align-items: center;
            padding: 0 25px;
            color: var(--text-dark);
            font-size: 0.95em;
            font-weight: 500;
            border-top-left-radius: 0; /* Sin bordes redondeados */
            border-top-right-radius: 0; /* Sin bordes redondeados */
            box-shadow: inset 3px 3px 7px var(--dark-shadow), inset -3px -3px 7px var(--light-shadow);
            z-index: 10;
        }

        .status-bar .left, .status-bar .right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /*
         * Área de contenido principal con desplazamiento.
         * Padding ajustado para una composición visual equilibrada.
         */
        .app-content {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            background-color: var(--bg-color);
            padding-top: 20px; /* Ajustado para eliminar el espacio de la barra de estado */
            padding-bottom: calc(var(--nav-bar-height) + 20px);
            -webkit-overflow-scrolling: touch; /* Desplazamiento suave en iOS */
        }

        /*
         * Sección de encabezado con barra de progreso.
         * Tipografía fluida para un diseño adaptable y una barra de progreso integrada.
         */
        .header-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .header-section h2 {
            color: var(--text-light);
            font-size: clamp(1.1em, 3vw, 1.3em); /* Tamaño de fuente fluido */
            font-weight: 600;
            margin-bottom: 15px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .progress-bar-container {
            background-color: var(--dark-shadow);
            border-radius: 10px;
            height: 8px;
            margin: 0 auto;
            width: 80%;
            box-shadow: inset 2px 2px 5px var(--dark-shadow), inset -2px -2px 5px var(--light-shadow);
        }

        .progress-bar-fill {
            background-color: var(--primary-accent);
            border-radius: 10px;
            height: 100%;
            width: 60%; /* Ejemplo de progreso, se puede animar con JS */
            transition: width 0.5s ease-out;
        }

        .question-text {
            color: var(--primary-accent);
            font-size: clamp(1.4em, 4vw, 1.8em); /* Tamaño de fuente fluido y más grande */
            font-weight: 700;
            margin-top: 30px;
            margin-bottom: 25px;
            /* Sombra de texto sutil para el brillo y un efecto de relieve */
            text-shadow: 0 0 8px rgba(255, 0, 255, 0.4), 1px 1px 2px rgba(0, 0, 0, 0.3); 
        }

        /*
         * Lista de elementos de módulo: el corazón de la interacción.
         * Se han mejorado los estados de `:hover` y `:active` para una respuesta táctil premium.
         */
        .module-list {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin-bottom: 30px;
        }

        .module-item {
            background-color: var(--bg-color);
            border-radius: var(--border-radius-md);
            /* Sombras más suaves y profundas para el estado normal */
            box-shadow: 
                8px 8px 16px var(--dark-shadow), 
                -8px -8px 16px var(--light-shadow),
                inset 0 0 5px rgba(255, 255, 255, 0.02); /* Sutil brillo interno */
            padding: 18px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Curva de animación más elegante */
            will-change: transform, box-shadow; /* Optimización para animaciones */
        }

        .module-item:hover {
            /* Brillo fucsia más intenso al pasar el ratón, manteniendo las sombras neumórficas */
            box-shadow: 
                0 0 25px 10px var(--primary-accent), 
                8px 8px 16px var(--dark-shadow), -8px -8px 16px var(--light-shadow);
            transform: translateY(-5px) scale(1.01); /* Ligero levantamiento y escala para un efecto "flotante" */
        }

        .module-item:active {
            /* Efecto de presión más pronunciado con un brillo interno y un pequeño halo */
            box-shadow: 
                inset 4px 4px 8px var(--dark-shadow), 
                inset -4px -4px 8px var(--light-shadow),
                0 0 15px 5px rgba(255, 255, 255, 0.15); 
            transform: translateY(0) scale(0.98); /* Se presiona ligeramente */
        }

        .module-item-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Contenedor del icono: un botón redondeado con efecto de presión neumórfico. */
        .icon-container {
            background-color: var(--bg-color);
            width: 48px; /* Ligeramente más grande */
            height: 48px; /* Ligeramente más grande */
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            /* Sombra interna y un brillo blanco sutil para un efecto de "profundidad" */
            box-shadow: 
                inset 3px 3px 7px var(--dark-shadow), 
                inset -3px -3px 7px var(--light-shadow),
                0 0 10px 3px rgba(255, 255, 255, 0.1); 
            transition: box-shadow 0.3s ease, transform 0.3s ease;
            will-change: transform, box-shadow;
        }

        .module-icon {
            color: var(--primary-accent);
            font-size: 1.8em; /* Icono ligeramente más grande */
            transition: color 0.3s ease, text-shadow 0.3s ease;
        }

        .module-item:active .icon-container {
            /* Brillo intenso al presionar el icono */
            box-shadow: 
                inset 2px 2px 5px var(--dark-shadow), 
                inset -2px -2px 5px var(--light-shadow),
                0 0 30px 12px var(--primary-accent);
            transform: scale(0.92); /* Efecto de presión más pronunciado */
        }

        .module-name {
            color: var(--text-light);
            font-size: 1.1em;
            font-weight: 600;
        }

        .module-info {
            display: none; /* Mantener oculto por ahora, pero listo para ser usado */
            color: var(--secondary-accent);
            font-size: 0.9em;
            font-weight: 500;
        }

        .module-arrow i {
            color: var(--secondary-accent);
            font-size: 1.2em;
        }

        /*
         * Botón de acción principal: "Ingreso de Venta".
         * Efectos de sombra y transformación para una experiencia táctil y visualmente atractiva.
         */
        .main-action-button {
            background-color: var(--bg-color);
            color: var(--primary-accent);
            border: none;
            border-radius: var(--border-radius-md);
            box-shadow: 10px 10px 20px var(--dark-shadow), -10px -10px 20px var(--light-shadow);
            padding: 20px 30px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            width: calc(100% - 60px);
            margin: 0 auto 30px auto;
            display: block;
            will-change: transform, box-shadow;
        }

        .main-action-button:hover {
            box-shadow: inset 7px 7px 14px var(--dark-shadow), inset -7px -7px 14px var(--light-shadow);
            transform: scale(0.98);
        }

        .main-action-button:active {
            box-shadow: inset 5px 5px 10px var(--dark-shadow), inset -5px -5px 10px var(--light-shadow),
                        0 0 35px 15px var(--primary-accent); /* Brillo más fuerte al presionar */
            transform: scale(0.93); /* Efecto de presión más profundo */
        }

        #btn-ingreso-venta-main {
            color: var(--tertiary-accent); /* Color cian para este botón específico */
        }

        #btn-ingreso-venta-main:active {
            box-shadow: inset 5px 5px 10px var(--dark-shadow), inset -5px -5px 10px var(--light-shadow),
                        0 0 35px 15px var(--tertiary-accent); /* Brillo cian al presionar */
        }

        /*
         * Barra de navegación inferior (El Dock de macOS).
         * Diseño glassmorphism con efectos de magnificación y transiciones fluidas.
         * Ahora ocupa todo el ancho y no tiene perspectiva 3D.
         */
        .nav-bar {
            position: absolute;
            bottom: 0; /* Pegado al fondo */
            left: 0;
            right: 0;
            height: var(--nav-bar-height);
            background-color: rgba(42, 0, 79, 0.7); /* Fondo semi-transparente */
            backdrop-filter: blur(20px); /* Efecto de cristal esmerilado */
            -webkit-backdrop-filter: blur(20px); /* Compatibilidad con WebKit */
            border-radius: 0; /* Sin bordes redondeados */
            display: flex; /* Direct flex container for items */
            align-items: flex-end; /* Alinea los ítems en la parte inferior para que crezcan hacia arriba */
            box-shadow: inset 3px 3px 7px var(--dark-shadow), inset -3px -3px 7px var(--light-shadow); /* Sombra interna neumórfica */
            z-index: 10;
            width: 100%; /* Ocupa todo el ancho */

            /* Propiedades para el carrusel táctil */
            overflow-x: scroll; /* Permite el desplazamiento horizontal */
            scroll-snap-type: x mandatory; /* Fuerza el "snap" a los ítems */
            -webkit-overflow-scrolling: touch; /* Desplazamiento suave en iOS */
            scrollbar-width: none; /* Oculta la barra de desplazamiento para Firefox */
            -ms-overflow-style: none;  /* Oculta la barra de desplazamiento para IE y Edge */
            gap: 15px; /* Espacio entre los ítems del dock */
            padding-left: 50px; /* Padding para permitir que el primer ítem se centre */
            padding-right: 50px; /* Padding para permitir que el último ítem se centre */

            cursor: grab; /* Indica que es arrastrable */
            touch-action: pan-x; /* Permite el desplazamiento horizontal táctil */
            /* Eliminamos la transformación 3D */
            transform: none; 
            transform-origin: unset;
        }

        .nav-bar:active {
            cursor: grabbing; /* Indica que se está arrastrando */
        }

        /* Reflejo del Dock - Eliminado */
        .nav-bar::after {
            display: none;
        }

        /* Oculta la barra de desplazamiento para navegadores basados en WebKit (Chrome, Safari) */
        .nav-bar::-webkit-scrollbar {
            display: none;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-dark);
            font-size: 0.85em;
            cursor: pointer;
            padding: 5px 10px; /* Espaciado interno para cada ítem */
            border-radius: 10px;
            transition: color 0.3s ease, box-shadow 0.3s ease; /* Transiciones solo para color y sombra */
            will-change: transform, color, box-shadow;
            position: relative; /* Para el posicionamiento del texto */
            overflow: visible; /* Permite que el icono magnificado y el texto se salgan del contenedor del ítem */
            flex-shrink: 0; /* Evita que los ítems se encojan */
            scroll-snap-align: center; /* Permite que el scroll se "enganche" a este ítem */
            min-width: 60px; /* Asegura un ancho mínimo para cada ítem */
            height: 100%; /* Ocupa la altura completa del nav-bar */
            justify-content: flex-end; /* Alinea el contenido en la parte inferior */
        }

        .nav-item i {
            font-size: 1.6em;
            margin-bottom: 6px;
            /* La transformación de escala ahora es controlada por JavaScript */
            transition: transform 0.15s ease-out, text-shadow 0.3s ease, color 0.3s ease; /* Transición más rápida para escala */
            transform-origin: bottom center; /* El icono se magnifica desde la base */
            will-change: transform, text-shadow;
        }

        .nav-item span {
            position: absolute;
            bottom: -20px; /* Oculto inicialmente debajo del ítem */
            opacity: 0;
            font-size: 0.75em; /* Tamaño de texto más pequeño para el label */
            font-weight: 500;
            color: var(--text-light);
            /* Transición más suave para la aparición del texto */
            transition: opacity 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: opacity, transform;
            white-space: nowrap; /* Evita que el texto se rompa en varias líneas */
            pointer-events: none; /* Asegura que el texto no interfiera con los eventos del icono */
            background-color: rgba(0, 0, 0, 0.7); /* Fondo para el tooltip del texto */
            padding: 4px 8px;
            border-radius: 5px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3); /* Sombra de texto para el brillo */
        }

        /* Estado de "hover" (solo para color y sombra de texto, escala por JS) */
        .nav-item:hover {
            color: var(--primary-accent);
            text-shadow: 0 0 10px var(--primary-accent), 0 0 15px rgba(255, 0, 255, 0.5); /* Brillo sutil en el icono */
        }

        /* Estado "activo" (solo para color y sombra de texto, escala por JS) */
        .nav-item.active {
            color: var(--primary-accent);
            font-weight: 600;
            /* Sombra interna sutil para el efecto de "presionado" */
            box-shadow: inset 2px 2px 5px var(--dark-shadow), inset -2px -2px 5px var(--light-shadow);
            text-shadow: 0 0 20px var(--primary-accent), 0 0 35px rgba(255, 0, 255, 0.9);
        }

        /*
         * Caja de mensajes personalizados (reemplazo de alert/confirm).
         * Animación de entrada y salida suave para una retroalimentación no intrusiva.
         */
        #custom-message-box {
            position: fixed;
            top: 25px;
            right: 25px;
            background-color: var(--message-box-success); /* Color por defecto */
            color: white;
            padding: 18px 30px;
            border-radius: 10px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3); /* Sombra más suave */
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        background-color 0.3s ease;
            font-family: 'Inter', sans-serif;
            font-size: 1.05em;
            min-width: 200px; /* Asegura que el mensaje sea visible */
            text-align: center;
        }

        /*
         * Estilos generales de los modales.
         * Transiciones elegantes para la aparición y desaparición, con un fondo más oscuro para enfoque.
         */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Fondo más oscuro para mayor enfoque, ligeramente más transparente */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
            /* Añadir un sutil desenfoque al fondo detrás del modal para un efecto más premium */
            backdrop-filter: blur(8px); /* Aumento del desenfoque para un efecto más "glassy" */
            -webkit-backdrop-filter: blur(8px);
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--bg-color); /* Fallback */
            padding: 35px; /* Ligeramente más padding para un look más espacioso */
            border-radius: var(--border-radius-lg);
            box-shadow: 
                15px 15px 30px rgba(0, 0, 0, 0.6), /* Sombra principal más oscura y difusa */
                -15px -15px 30px rgba(255, 255, 255, 0.08), /* Sombra clara más sutil */
                inset 0 0 20px rgba(255, 255, 255, 0.02); /* Brillo interno muy sutil */
            width: 90%; /* Un poco más de ancho para aprovechar el espacio */
            max-width: 400px; /* Aumento del ancho máximo */
            text-align: center;
            transform: translateY(0) scale(0.95); /* Inicia ligeramente más pequeño y centrado */
            opacity: 0;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            color: var(--modal-text-color); /* Color de texto general para modales */
        }

        .modal-overlay.show .modal-content {
            transform: translateY(0) scale(1); /* Escala a tamaño completo y se mantiene centrado */
            opacity: 1;
        }

        /* Estilo específico para los modales de login (initial-access-modal y admin-login-modal) */
        #initial-access-modal .modal-content,
        #admin-login-modal .modal-content {
            background: linear-gradient(145deg, var(--modal-bg-gradient-start), var(--modal-bg-gradient-end)); /* Gradiente del modal con transparencia */
            border-radius: 40px; /* Bordes más redondeados como en la imagen */
            padding: 45px 35px; /* Más padding para el contenido */
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7), /* Sombra más pronunciada */
                        inset 0 0 25px rgba(255, 255, 255, 0.05); /* Brillo interno */
            backdrop-filter: blur(25px); /* Efecto de cristal esmerilado más fuerte */
            -webkit-backdrop-filter: blur(25px);
        }

        #initial-access-modal h3,
        #admin-login-modal h3 {
            display: none; /* Ocultar títulos si el diseño de la imagen no los tiene explícitamente */
        }

        /* Icono de usuario en la parte superior del modal de login */
        .modal-user-icon {
            font-size: 5em; /* Tamaño grande del icono */
            color: var(--primary-accent); /* Color del icono */
            margin-bottom: 30px; /* Espacio debajo del icono */
            text-shadow: 0 0 15px rgba(255, 0, 255, 0.5); /* Sombra para el brillo */
        }

        /* Contenedor para inputs con iconos */
        .input-group {
            position: relative;
            margin-bottom: 30px; /* Espacio entre grupos de input */
            text-align: left; /* Alinea el label a la izquierda */
        }

        .input-group label {
            display: none; /* Ocultar labels si el diseño de la imagen no los tiene */
        }

        .input-group i {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            color: var(--modal-input-border); /* Color del icono */
            font-size: 1.2em;
            pointer-events: none; /* Asegura que el icono no bloquee el clic en el input */
        }

        .modal-content input[type="text"],
        .modal-content input[type="tel"],
        .modal-content input[type="password"] {
            width: calc(100% - 25px); /* Ajuste para el icono y padding */
            padding: 10px 0 10px 25px; /* Padding para el icono y texto */
            margin-bottom: 0; /* Controlado por el input-group */
            border: none;
            border-bottom: 2px solid var(--modal-input-border); /* Solo borde inferior */
            background-color: transparent; /* Fondo transparente */
            color: var(--modal-input-text); /* Color del texto del input */
            font-size: 1.1em;
            outline: none;
            box-shadow: none; /* Eliminar sombras neumórficas de los inputs para este estilo */
            transition: border-color 0.3s ease;
        }

        .modal-content input[type="text"]:focus,
        .modal-content input[type="tel"]:focus,
        .modal-content input[type="password"]:focus {
            border-color: var(--primary-accent); /* Borde fucsia al enfocar */
            box-shadow: none; /* Asegurar que no haya sombras adicionales */
        }

        /* Placeholder styling */
        .modal-content input::placeholder {
            color: rgba(255, 255, 255, 0.5); /* Placeholder más sutil */
        }

        /* "Remember me" y "Forgot Password?" */
        .modal-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px; /* Espacio antes del botón de login */
            font-size: 0.95em;
        }

        .modal-options input[type="checkbox"] {
            margin-right: 8px;
            /* Estilo básico para el checkbox, se puede personalizar más con CSS */
        }

        .modal-options a {
            color: var(--modal-link-color); /* Color cian para el enlace */
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .modal-options a:hover {
            color: var(--primary-accent); /* Cambia a fucsia al pasar el cursor */
        }

        /* Botones del modal (general) */
        .modal-content button {
            background: linear-gradient(to right, var(--modal-button-gradient-start), var(--modal-button-gradient-end)); /* Gradiente para el botón */
            color: var(--modal-text-color);
            border: none;
            border-radius: 15px; /* Bordes redondeados para el botón */
            padding: 18px 30px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4); /* Sombra para el efecto de elevación */
            transition: all 0.3s ease;
            width: 100%; /* Ocupa todo el ancho disponible */
            margin-bottom: 0; /* Eliminar margen inferior si es el último elemento */
        }

        .modal-content button:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6); /* Sombra más pronunciada al pasar el cursor */
            transform: translateY(-3px); /* Ligero levantamiento */
        }

        .modal-content button:active {
            transform: translateY(0); /* Vuelve a la posición original al presionar */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); /* Sombra más sutil al presionar */
        }

        /* Ajustes para el botón de WhatsApp en initial-access-modal */
        #send-request-button {
            background: linear-gradient(to right, #25D366, #128C7E); /* Colores de WhatsApp */
            margin-top: 20px;
        }
        #send-request-button:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6), 0 0 20px rgba(37, 211, 102, 0.5); /* Brillo verde */
        }
        #send-request-button:active {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        /* Botón de volver en initial-access-modal */
        #back-to-code-entry-button {
            background: none; /* Sin fondo */
            color: var(--modal-link-color); /* Color cian */
            box-shadow: none; /* Sin sombra */
            margin-top: 10px;
            font-size: 1em;
            font-weight: 500;
        }
        #back-to-code-entry-button:hover {
            color: var(--primary-accent);
            transform: none;
            box-shadow: none;
        }
        #back-to-code-entry-button:active {
            transform: none;
            box-shadow: none;
        }


        /* Estilos específicos para el Panel de Administración (no es un login, mantiene su estructura) */
        #admin-panel-modal .modal-content {
            background: linear-gradient(145deg, var(--modal-bg-gradient-start), var(--modal-bg-gradient-end));
            border-radius: var(--border-radius-lg);
            padding: 35px;
            box-shadow: 
                15px 15px 30px rgba(0, 0, 0, 0.6), 
                -15px -15px 30px rgba(255, 255, 255, 0.08), 
                inset 0 0 20px rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px); /* Ligeramente menos blur que el login */
            -webkit-backdrop-filter: blur(20px);
        }
        #admin-panel-modal h3 {
            display: block; /* Mantener el título del panel de admin */
            color: var(--primary-accent);
            margin-bottom: 25px;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.4);
        }
        #admin-panel-modal .modal-message {
            color: var(--text-dark);
            font-size: 0.95em;
            margin-bottom: 20px;
        }
        #admin-panel-modal .current-code {
            color: var(--tertiary-accent);
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 20px;
        }
        #admin-panel-modal label {
            display: block; /* Mantener labels para el panel de admin */
            text-align: left;
            margin-bottom: 8px;
            color: var(--text-dark);
            font-weight: 500;
        }
        #admin-panel-modal input[type="text"] {
            width: calc(100% - 24px); /* Ajuste de padding */
            padding: 14px 12px; /* Más padding para mejor tacto */
            margin-bottom: 20px;
            border: none;
            border-radius: 12px; /* Bordes ligeramente más redondeados */
            background-color: var(--dark-shadow);
            color: var(--text-light);
            box-shadow: inset 4px 4px 8px var(--dark-shadow), inset -4px -4px 8px var(--light-shadow);
            font-size: 1.05em;
        }
        #admin-panel-modal input[type="text"]:focus {
            box-shadow: inset 2px 2px 5px var(--dark-shadow), inset -2px -2px 5px var(--light-shadow),
                        0 0 0 3px var(--primary-accent), 0 0 10px 2px rgba(255, 0, 255, 0.4); 
        }
        #admin-panel-modal button {
            background: linear-gradient(to right, var(--primary-accent), var(--secondary-accent));
            box-shadow: 6px 6px 12px var(--dark-shadow), -6px -6px 12px var(--light-shadow);
        }
        #admin-panel-modal button:hover {
            box-shadow: inset 4px 4px 8px var(--dark-shadow), inset -4px -4px 8px var(--light-shadow);
            transform: scale(0.99);
        }
        #admin-panel-modal button:active {
            box-shadow: inset 3px 3px 7px var(--dark-shadow), inset -3px -3px 7px var(--light-shadow),
                        0 0 25px 10px var(--primary-accent); 
            transform: scale(0.96);
        }

        /* Modal de Actualización Forzada del Administrador (cuando el código expira) */
        #forced-admin-update-modal .modal-content {
            background: linear-gradient(145deg, var(--modal-bg-gradient-start), var(--modal-bg-gradient-end));
            border: 2px solid var(--primary-accent);
            border-radius: var(--border-radius-lg);
            padding: 35px;
            box-shadow: 
                15px 15px 30px rgba(0, 0, 0, 0.6), 
                -15px -15px 30px rgba(255, 255, 255, 0.08), 
                inset 0 0 20px rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        #forced-admin-update-modal h3 {
            display: block; /* Mantener el título */
            color: var(--primary-accent);
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.4);
        }
        #forced-admin-update-modal .modal-message {
            color: var(--text-light);
            font-size: 1.0em;
            font-weight: 500;
        }

        /* Botón de cierre "X" - General styling for modals that keep it */
        .modal-close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: transparent; /* Fondo transparente para este estilo */
            border: none;
            color: rgba(255, 255, 255, 0.7); /* Color blanco sutil */
            font-size: 1.5em; /* Tamaño del ícono */
            cursor: pointer;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.2s ease;
            box-shadow: none; /* Eliminar sombra neumórfica para este estilo */
        }

        .modal-close-button:hover {
            color: var(--primary-accent); /* Fucsia al pasar el cursor */
            background-color: rgba(255, 255, 255, 0.1); /* Fondo sutil al pasar el cursor */
            transform: scale(1.1); /* Ligero aumento de tamaño */
        }

        .modal-close-button:active {
            transform: scale(0.9); /* Efecto de presión */
            background-color: rgba(255, 255, 255, 0.2);
        }

        /*
         * Media Queries para una Responsividad Impecable.
         * Ahora, las media queries se centran en ajustar el diseño para pantallas más pequeñas,
         * ya que el diseño base ya es de pantalla completa.
         */
        @media (min-width: 800px) {
            /* No hay cambios específicos para .app-frame o status-bar en desktop,
               ya que el diseño base ya es de pantalla completa */
            .nav-bar {
                bottom: 30px; /* Elevar un poco el dock en pantallas grandes */
                height: 85px; /* Ligeramente más alto */
                border-radius: 40px; /* Mantener bordes redondeados para el dock en desktop */
                max-width: 90%; /* Limita el ancho del dock en pantallas más grandes */
                left: 50%; /* Centrar el dock */
                transform: translateX(-50%); /* Centrar el dock */
            }
            .nav-item i {
                font-size: 1.8em; /* Iconos más grandes en desktop */
            }
            .nav-item span {
                transform: translateY(-55px); /* Texto se eleva más */
                font-size: 0.85em;
            }
            #floating-deploy-button {
                right: 40px; /* Más espacio desde el borde derecho */
                bottom: 120px; /* Más espacio desde abajo para no chocar con el dock */
                width: 130px; /* Ancho ajustado para el texto */
                height: 55px; /* Alto ajustado */
                font-size: 0.85em; /* Fuente más pequeña para asegurar que quepa */
                padding: 10px 15px; /* Padding reducido */
            }
            #floating-deploy-button i {
                font-size: 1.5em; /* Icono un poco más pequeño en desktop */
            }
        }

        @media (max-width: 799px) { /* Para pantallas más pequeñas que 800px (móvil y tablet) */
            .app-frame {
                /* Ya es 100vw/100vh por defecto, no necesita redefinición */
            }
            .status-bar {
                border-top-left-radius: 0;
                border-top-right-radius: 0;
            }
            .nav-bar {
                bottom: 0; /* Pegado al fondo en móvil */
                border-radius: 0; /* Sin bordes redondeados en móvil */
                padding: 0 10px; /* Ajuste de padding */
                transform: none; /* Eliminar cualquier transformación 3D */
            }
            .nav-item i {
                font-size: 1.5em;
            }
            .nav-item span {
                transform: translateY(-40px);
            }
            #floating-deploy-button {
                right: 20px; /* Menos espacio desde el borde derecho */
                bottom: 100px; /* Menos espacio desde abajo para no chocar con el dock */
                width: 110px; /* Más pequeño */
                height: 45px; /* Más pequeño */
                font-size: 0.75em; /* Fuente más pequeña */
                padding: 6px 12px; /* Padding más reducido */
            }
            #floating-deploy-button i {
                font-size: 1.2em; /* Icono más pequeño en móvil */
            }
        }

        /* Estilos para el botón flotante de despliegue */
        #floating-deploy-button {
            position: absolute; /* Usar absolute dentro de app-frame */
            right: 25px; /* Distancia desde el borde derecho */
            bottom: 100px; /* Distancia desde la parte inferior (por encima del nav-bar) */
            background: linear-gradient(45deg, var(--tertiary-accent), var(--primary-accent)); /* Gradiente cian a fucsia */
            color: var(--text-light);
            border: none;
            border-radius: var(--border-radius-md);
            padding: 15px 25px; /* Padding original, se ajusta en media queries */
            font-size: 1.05em; /* Fuente original, se ajusta en media queries */
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4), 0 0 15px rgba(0, 255, 255, 0.6); /* Sombra y brillo cian */
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 15; /* Asegura que esté por encima de otros elementos */
            will-change: transform, box-shadow;
        }

        #floating-deploy-button i {
            font-size: 1.6em;
            color: var(--text-light); /* Color del icono */
        }

        #floating-deploy-button:hover {
            transform: translateY(-5px) scale(1.02); /* Ligero levantamiento y escala */
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.6), 0 0 25px rgba(0, 255, 255, 0.8); /* Sombra y brillo más intensos */
        }

        #floating-deploy-button:active {
            transform: translateY(0) scale(0.98); /* Efecto de presión */
            box-shadow: inset 3px 3px 7px rgba(0, 0, 0, 0.3), inset -3px -3px 7px rgba(255, 255, 255, 0.1),
                        0 0 10px rgba(0, 255, 255, 0.4); /* Sombra interna y brillo sutil */
        }

        /* Estilo para el overlay de carga */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

    </style>
</head>
<body>
    <div class="app-frame" role="application" aria-label="Consola WOM Venta">
        <!-- Barra de Estado Superior: Indicadores esenciales del dispositivo (AHORA OCULTA) -->
        <div class="status-bar">
            <div class="left" aria-label="Hora actual">09:00</div>
            <div class="right">
                <i class="fas fa-signal" aria-label="Intensidad de señal"></i>
                <i class="fas fa-wifi" aria-label="Estado de conexión Wi-Fi"></i>
                <i class="fas fa-battery-full" aria-label="Nivel de batería"></i>
            </div>
        </div>

        <!-- Área de Contenido Principal: Donde residen los módulos de la aplicación -->
        <div class="app-content" role="main">
            <header class="header-section">
                <h2 aria-level="2">HOY</h2>
                <div class="progress-bar-container" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" aria-label="Progreso de tareas diarias">
                    <div class="progress-bar-fill"></div>
                </div>
                <p class="question-text">¿Qué quieres hacer hoy?</p>
            </header>

            <!-- El banner de imagen/video y el reloj analógico han sido eliminados de aquí -->

            <!-- Lista de Módulos: Cada elemento es un punto de interacción clave -->
            <section class="module-list" aria-label="Módulos de la aplicación">
                <!-- Módulo 1: Buscador de Direcciones -->
                <div class="module-item" id="module-direcciones" role="button" tabindex="0" aria-label="Buscador de Direcciones">
                    <div class="module-item-left">
                        <div class="icon-container">
                            <i class="fas fa-map-marked-alt module-icon" aria-hidden="true"></i>
                        </div>
                        <span class="module-name">Buscador de Direcciones</span>
                    </div>
                    <div class="module-arrow"><i class="fas fa-chevron-right" aria-hidden="true"></i></div>
                </div>

                <!-- Módulo 2: Calculadora Boleta -->
                <div class="module-item" id="module-calculadora" role="button" tabindex="0" aria-label="Calculadora Boleta">
                    <div class="module-item-left">
                        <div class="icon-container">
                            <i class="fas fa-calculator module-icon" aria-hidden="true"></i>
                        </div>
                        <span class="module-name">Calculadora Boleta</span>
                    </div>
                    <div class="module-arrow"><i class="fas fa-chevron-right" aria-hidden="true"></i></div>
                </div>

                <!-- Módulo 3: Evaluar RUT -->
                <div class="module-item" id="module-evaluar-rut" role="button" tabindex="0" aria-label="Evaluar RUT">
                    <div class="module-item-left">
                        <div class="icon-container">
                            <i class="fas fa-id-card module-icon" aria-hidden="true"></i>
                        </div>
                        <span class="module-name">Evaluar RUT</span>
                    </div>
                    <div class="module-arrow"><i class="fas fa-chevron-right" aria-hidden="true"></i></div>
                </div>

                <!-- Módulo 4: Condiciones Comerciales -->
                <div class="module-item" id="module-condiciones-comerciales" role="button" tabindex="0" aria-label="Condiciones Comerciales">
                    <div class="module-item-left">
                        <div class="icon-container">
                            <i class="fas fa-file-contract module-icon" aria-hidden="true"></i>
                        </div>
                        <span class="module-name">Condiciones Comerciales</span>
                    </div>
                    <div class="module-arrow"><i class="fas fa-chevron-right" aria-hidden="true"></i></div>
                </div>

                <!-- Módulo 5: Factibilidad -->
                <div class="module-item" id="module-factibilidad" role="button" tabindex="0" aria-label="Factibilidad">
                    <div class="module-item-left">
                        <div class="icon-container">
                            <i class="fas fa-check-circle module-icon" aria-hidden="true"></i>
                        </div>
                        <span class="module-name">Factibilidad</span>
                    </div>
                    <div class="module-arrow"><i class="fas fa-chevron-right" aria-hidden="true"></i></div>
                </div>
            </section>

            <!-- Botón de Acción Principal: "Ingreso de Venta" -->
            <button class="main-action-button" id="btn-ingreso-venta-main" role="button" aria-label="Ingreso de Venta">
                Ingreso de Venta
            </button>
        </div>

        <!-- Barra de Navegación Inferior: Acceso rápido a funciones clave (Carrusel Estilo Dock) -->
        <nav class="nav-bar" aria-label="Navegación principal">
            <!-- Ítem de Navegación: Inicio (Acceso General) -->
            <div class="nav-item" id="nav-home" role="link" tabindex="0" aria-label="Inicio">
                <i class="fas fa-house-chimney" aria-hidden="true"></i>
                <span>Inicio</span>
            </div>
            <!-- Ítem de Navegación: Contacto (Acceso General - Puede ser para admin o soporte) -->
            <div class="nav-item" id="nav-contact" role="link" tabindex="0" aria-label="Contactar Administrador">
                <i class="fas fa-envelope" aria-hidden="true"></i>
                <span>Contacto</span>
            </div>
            <!-- Ítem de Navegación: Añadir Nuevo (Acceso General) -->
            <div class="nav-item" id="nav-add" role="link" tabindex="0" aria-label="Añadir Nuevo">
                <i class="fas fa-plus-square" aria-hidden="true"></i>
                <span>Añadir</span>
            </div>
            <!-- Ítem de Navegación: Perfil de Usuario (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-profile" data-admin-required="true" role="link" tabindex="0" aria-label="Perfil de Usuario">
                <i class="fas fa-circle-user" aria-hidden="true"></i>
                <span>Perfil</span>
            </div>
            <!-- Ítem de Navegación: Panel de Administrador (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-admin" data-admin-required="true" role="link" tabindex="0" aria-label="Panel de Administrador">
                <i class="fas fa-user-shield" aria-hidden="true"></i>
                <span>Admin</span>
            </div>
            <!-- Ítem de Navegación: Reportes (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-reports" data-admin-required="true" role="link" tabindex="0" aria-label="Reportes">
                <i class="fas fa-chart-pie" aria-hidden="true"></i>
                <span>Reportes</span>
            </div>
            <!-- Ítem de Navegación: Configuración (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-settings" data-admin-required="true" role="link" tabindex="0" aria-label="Configuración">
                <i class="fas fa-gear" aria-hidden="true"></i>
                <span>Configuración</span>
            </div>
            <!-- Ítem de Navegación: Mensajes (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-messages" data-admin-required="true" role="link" tabindex="0" aria-label="Mensajes">
                <i class="fas fa-message" aria-hidden="true"></i>
                <span>Mensajes</span>
            </div>
            <!-- Ítem de Navegación: Calendario (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-calendar" data-admin-required="true" role="link" tabindex="0" aria-label="Calendario">
                <i class="fas fa-calendar-days" aria-hidden="true"></i>
                <span>Calendario</span>
            </div>
            <!-- Ítem de Navegación: Documentos (Acceso Administrador Requerido) -->
            <div class="nav-item" id="nav-docs" data-admin-required="true" role="link" tabindex="0" aria-label="Documentos">
                <i class="fas fa-file-lines" aria-hidden="true"></i>
                <span>Documentos</span>
            </div>
        </nav>

        <!-- Botón Flotante de Despliegue -->
        <button id="floating-deploy-button" role="button" aria-label="Desplegar herramientas">
            <i class="fas fa-rocket" aria-hidden="true"></i>
            DESPLIEGUE
        </button>
    </div>

    <!-- Modal de Acceso Inicial: Punto de entrada para usuarios (ESTILO DE LA IMAGEN) -->
    <div class="modal-overlay" id="initial-access-modal" role="dialog" aria-modal="true" aria-labelledby="initial-modal-title">
        <div class="modal-content">
            <!-- Icono de usuario en la parte superior del modal -->
            <i class="fas fa-user-circle modal-user-icon" aria-hidden="true"></i>
            <!-- Título y mensaje ocultos para coincidir con la imagen, pero se pueden mostrar si es necesario -->
            <h3 id="initial-modal-title" style="display: none;">Acceso a Consola WOM Venta</h3>
            <p class="modal-message" id="initial-modal-message" style="display: none;"></p>

            <!-- Sección 1: Ingreso de Código / Botón de Solicitud -->
            <div id="initial-access-section">
                <div class="input-group">
                    <i class="fas fa-key" aria-hidden="true"></i>
                    <label for="unique-code">Código Único:</label>
                    <input type="text" id="unique-code" placeholder="Ingresa tu código" required aria-required="true">
                </div>
                <button type="button" id="access-button" role="button">LOGIN</button>
                <button type="button" id="request-new-code-button" role="button" style="background: none; color: var(--modal-link-color); box-shadow: none; margin-top: 10px; font-size: 1em; font-weight: 500;">Solicitar Nuevo Código</button>
            </div>

            <!-- Sección 2: Detalles de Solicitud (Inicialmente oculta) -->
            <div id="request-details-section" style="display: none;">
                <div class="input-group">
                    <i class="fas fa-user" aria-hidden="true"></i>
                    <label for="user-name">Nombre:</label>
                    <input type="text" id="user-name" placeholder="Tu nombre" required aria-required="true">
                </div>
                <div class="input-group">
                    <i class="fas fa-phone" aria-hidden="true"></i>
                    <label for="user-phone">Teléfono:</label>
                    <input type="tel" id="user-phone" placeholder="Ej: 56912345678" required aria-required="true">
                </div>

                <button type="button" id="send-request-button" role="button">Enviar Solicitud por WhatsApp</button>
                <button type="button" id="back-to-code-entry-button" role="button" style="background: none; color: var(--modal-link-color); box-shadow: none; margin-top: 10px; font-size: 1em; font-weight: 500;">Volver</button>
            </div>
        </div>
    </div>

    <!-- Modal de Acceso de Administrador (ESTILO DE LA IMAGEN) -->
    <div class="modal-overlay" id="admin-login-modal" role="dialog" aria-modal="true" aria-labelledby="admin-login-title">
        <div class="modal-content">
            <!-- Icono de usuario en la parte superior del modal -->
            <i class="fas fa-user-circle modal-user-icon" aria-hidden="true"></i>
            <!-- Título y mensaje ocultos para coincidir con la imagen, pero se pueden mostrar si es necesario -->
            <h3 id="admin-login-title" style="display: none;">Acceso de Administrador</h3>
            <p class="modal-message" id="admin-login-message" style="display: none;"></p>
            <form id="admin-login-form">
                <!-- Campo de Contraseña (Email ID eliminado según solicitud) -->
                <div class="input-group">
                    <i class="fas fa-lock" aria-hidden="true"></i>
                    <label for="admin-password">Contraseña:</label>
                    <input type="password" id="admin-password" placeholder="Contraseña" required aria-required="true">
                </div>
                <div class="modal-options">
                    <label>
                        <input type="checkbox" id="remember-me"> Recordarme
                    </label>
                    <a href="#" id="forgot-password-link">¿Olvidaste tu contraseña?</a>
                </div>
                <button type="submit" role="button">LOGIN</button>
            </form>
        </div>
    </div>

    <!-- Modal del Panel de Administración (Mantiene botón de cierre y estilo neumórfico original) -->
    <div class="modal-overlay" id="admin-panel-modal" role="dialog" aria-modal="true" aria-labelledby="admin-panel-title">
        <div class="modal-content">
            <!-- Botón de cierre "X" para el panel de administración -->
            <button class="modal-close-button" id="admin-panel-close-button" aria-label="Cerrar panel de administración"><i class="fas fa-times" aria-hidden="true"></i></button>
            <h3 id="admin-panel-title">Panel de Administración</h3>
            <p class="modal-message">Aquí puedes cambiar el código único de acceso.</p>
            <p>Código Único Actual: <span class="current-code" id="current-unique-code"></span></p>
            <form id="update-code-form">
                <label for="new-unique-code">Nuevo Código Único:</label>
                <input type="text" id="new-unique-code" placeholder="Ingresa el nuevo código" required aria-required="true">
                <button type="submit" role="button">Guardar Nuevo Código</button>
            </form>
        </div>
    </div>

    <!-- Modal de Actualización Forzada del Administrador (cuando el código expira) -->
    <div class="modal-overlay" id="forced-admin-update-modal" role="alertdialog" aria-modal="true" aria-labelledby="forced-update-title" aria-describedby="forced-update-message">
        <div class="modal-content">
            <h3 id="forced-update-title">Código de Acceso Expirado</h3>
            <p class="modal-message" id="forced-update-message">El código de acceso ha expirado. Por favor, contacta al administrador para que actualice el código.</p>
            <p class="modal-message">Una vez actualizado, podrás volver a solicitar acceso con el nuevo código.</p>
        </div>
    </div>

    <!-- Overlay de carga inicial -->
    <div id="loading-overlay">Cargando aplicación...</div>

    <script>
        // Envuelve todo el código JavaScript en un evento 'DOMContentLoaded'
        // para asegurar que el DOM esté completamente cargado antes de interactuar con él.
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Referencias a elementos del DOM para una gestión eficiente
                const moduleDirecciones = document.getElementById('module-direcciones');
                const moduleCalculadora = document.getElementById('module-calculadora');
                const moduleEvaluarRut = document.getElementById('module-evaluar-rut');
                const moduleCondicionesComerciales = document.getElementById('module-condiciones-comerciales');
                const moduleFactibilidad = document.getElementById('module-factibilidad');
                const btnIngresoVentaMain = document.getElementById('btn-ingreso-venta-main');
                const floatingDeployButton = document.getElementById('floating-deploy-button'); // Nuevo botón flotante

                // Elementos de la barra de navegación
                const navBar = document.querySelector('.nav-bar');
                const navItems = document.querySelectorAll('.nav-item');
                const navHome = document.getElementById('nav-home');
                const navContact = document.getElementById('nav-contact');
                const navAdd = document.getElementById('nav-add');
                const navAdmin = document.getElementById('nav-admin');
                const navProfile = document.getElementById('nav-profile');
                const navReports = document.getElementById('nav-reports');
                const navSettings = document.getElementById('nav-settings');
                const navMessages = document.getElementById('nav-messages');
                const navCalendar = document.getElementById('nav-calendar');
                const navDocs = document.getElementById('nav-docs');

                // Variables para controlar el estado de inicio de sesión del administrador
                let isAdminLoggedIn = false;

                // Configuración de WhatsApp para el administrador
                const adminWhatsappNumber = '56927372611';
                const generalWhatsappMessage = 'Hola, necesito ayuda con la aplicación.';

                // Variables para almacenar los valores (ahora usando localStorage para Canvas)
                // NOTA: Para la versión de Apps Script, estos valores se cargarían desde PropertiesService.
                let correctUniqueCode = localStorage.getItem('correctUniqueCode') || '123456';
                let lastCodeChangeTimestamp = parseInt(localStorage.getItem('lastCodeChangeTimestamp')) || Date.now();
                const adminPassword = 'admin123'; // Contraseña de admin fija para Canvas

                const CODE_EXPIRATION_DAYS = 15 * 24 * 60 * 60 * 1000; 
                // const CODE_EXPIRATION_DAYS = 10 * 1000; // Para pruebas: 10 segundos

                // Referencias a elementos del modal de acceso inicial
                const initialAccessModal = document.getElementById('initial-access-modal');
                const initialModalTitle = document.getElementById('initial-modal-title');
                const initialModalMessage = document.getElementById('initial-modal-message');
                const initialAccessSection = document.getElementById('initial-access-section');
                const requestDetailsSection = document.getElementById('request-details-section');
                
                const uniqueCodeInput = document.getElementById('unique-code');
                const accessButton = document.getElementById('access-button');
                const requestNewCodeButton = document.getElementById('request-new-code-button');

                const userNameInput = document.getElementById('user-name');
                const userPhoneInput = document.getElementById('user-phone');
                const sendRequestButton = document.getElementById('send-request-button');
                const backToCodeEntryButton = document.getElementById('back-to-code-entry-button');

                // Referencias a elementos de los modales de administrador
                const adminLoginModal = document.getElementById('admin-login-modal');
                const adminLoginMessage = document.getElementById('admin-login-message');
                const adminLoginForm = document.getElementById('admin-login-form');
                const adminPasswordInput = document.getElementById('admin-password');
                const rememberMeCheckbox = document.getElementById('remember-me'); // Nuevo checkbox
                const forgotPasswordLink = document.getElementById('forgot-password-link'); // Nuevo enlace

                const adminPanelModal = document.getElementById('admin-panel-modal');
                const currentUniqueCodeDisplay = document.getElementById('current-unique-code');
                const updateCodeForm = document.getElementById('update-code-form');
                const newUniqueCodeInput = document.getElementById('new-unique-code');
                const adminPanelCloseButton = document.getElementById('admin-panel-close-button');

                const forcedAdminUpdateModal = document.getElementById('forced-admin-update-modal');

                const loadingOverlay = document.getElementById('loading-overlay');

                /*
                 * showInitialAccessSection(): Muestra la sección para ingresar el código o solicitar uno nuevo.
                 * showRequestDetailsSection(): Muestra la sección para ingresar nombre y teléfono para solicitar código.
                 */
                function showInitialAccessSection() {
                    initialModalTitle.textContent = 'Acceso a Consola WOM Venta';
                    initialModalMessage.textContent = 'Ingresa tu código único o solicita uno nuevo.';
                    initialModalMessage.style.display = 'none'; // Asegura que el mensaje esté oculto por defecto
                    initialAccessSection.style.display = 'block';
                    requestDetailsSection.style.display = 'none';
                    uniqueCodeInput.value = '';
                }

                function showRequestDetailsSection() {
                    initialModalTitle.textContent = 'Solicitar Nuevo Código';
                    initialModalMessage.textContent = 'Por favor, ingresa tus datos para que el administrador te envíe un código.';
                    initialModalMessage.style.display = 'none'; // Asegura que el mensaje esté oculto por defecto
                    initialAccessSection.style.display = 'none';
                    requestDetailsSection.style.display = 'block';
                    userNameInput.value = '';
                    userPhoneInput.value = '';
                }

                /*
                 * initializeApp(): Función para cargar propiedades y decidir qué modal mostrar.
                 * Adaptada para usar localStorage en Canvas.
                 */
                function initializeApp() {
                    const hasAccessedBefore = localStorage.getItem('hasAccessedBefore') === 'true';
                    lastCodeChangeTimestamp = parseInt(localStorage.getItem('lastCodeChangeTimestamp')) || Date.now();
                    correctUniqueCode = localStorage.getItem('correctUniqueCode') || '123456';
                    isAdminLoggedIn = localStorage.getItem('adminRemembered') === 'true';

                    console.log("--- Estado de Carga de la Aplicación (Canvas Preview) ---");
                    console.log("localStorage 'hasAccessedBefore':", hasAccessedBefore);
                    console.log("localStorage 'lastCodeChangeTimestamp':", new Date(lastCodeChangeTimestamp));
                    console.log("localStorage 'correctUniqueCode':", correctUniqueCode);
                    console.log("localStorage 'adminRemembered':", isAdminLoggedIn);
                    console.log("Tiempo Actual:", new Date(Date.now()));
                    console.log("Umbral de Expiración del Código (ms):", CODE_EXPIRATION_DAYS);
                    console.log("Tiempo transcurrido desde el último cambio de código:", (Date.now() - lastCodeChangeTimestamp), "ms");

                    const currentTime = Date.now();
                    const timeElapsed = currentTime - lastCodeChangeTimestamp;

                    if (!hasAccessedBefore) {
                        console.log("El usuario NO ha accedido antes. Mostrando modal de acceso inicial.");
                        initialAccessModal.classList.add('show');
                        showInitialAccessSection();
                    } else {
                        if (timeElapsed >= CODE_EXPIRATION_DAYS) {
                            console.log("El código ha EXPIRADO. Mostrando modal de actualización forzada del administrador.");
                            forcedAdminUpdateModal.classList.add('show');
                            localStorage.removeItem('hasAccessedBefore'); // Elimina para forzar reautenticación
                        } else {
                            console.log("El código sigue siendo VÁLIDO. Procediendo al contenido de la aplicación.");
                            initialAccessModal.classList.remove('show');
                            forcedAdminUpdateModal.classList.remove('show');
                            adminLoginModal.classList.remove('show');
                            adminPanelModal.classList.remove('show');
                        }
                    }

                    // Ocultar overlay de carga
                    loadingOverlay.style.opacity = '0';
                    loadingOverlay.addEventListener('transitionend', () => loadingOverlay.remove());

                    // Aplicación inicial del efecto del dock
                    if (navItems.length > 0) {
                        navItems[0].scrollIntoView({ behavior: 'smooth', inline: 'center' });
                        setTimeout(applyDockEffect, 300);
                    }
                }

                /*
                 * isValidChileanPhoneNumber(): Valida el formato de un número de teléfono chileno.
                 * Asegura que el número cumple con el patrón esperado para WhatsApp.
                 */
                function isValidChileanPhoneNumber(phone) {
                    const regex = /^(?:\+?56)?9\d{8}$/; // Permite +56 o no, seguido de 9 y 8 dígitos
                    return regex.test(phone);
                }

                /*
                 * Manejadores de Eventos para el Modal de Acceso Inicial.
                 * Controla la navegación entre las secciones de ingreso de código y solicitud.
                 */
                requestNewCodeButton.addEventListener('click', showRequestDetailsSection);
                backToCodeEntryButton.addEventListener('click', showInitialAccessSection);

                sendRequestButton.addEventListener('click', () => {
                    const userName = userNameInput.value.trim();
                    const userPhone = userPhoneInput.value.trim();

                    if (!userName || !userPhone) {
                        showCustomMessageBox('Por favor, completa todos los campos para solicitar acceso.', 'error');
                        return;
                    }

                    if (!isValidChileanPhoneNumber(userPhone)) {
                        showCustomMessageBox('Por favor, ingresa un número de teléfono válido (ej: 56912345678).', 'error');
                        return;
                    }

                    const messageForAdmin = `Solicitud de acceso a Consola WOM Venta:\n\nNombre: ${userName}\nTeléfono: ${userPhone}\n\nPor favor, envíame un código único de acceso.`;
                    
                    const whatsappUrl = `https://wa.me/${adminWhatsappNumber}?text=${encodeURIComponent(messageForAdmin)}`;
                    window.open(whatsappUrl, '_blank');

                    showInitialAccessSection(); // Vuelve a la sección de ingreso de código después de enviar la solicitud
                    initialModalMessage.textContent = '¡Solicitud enviada! Espera el código único que te te enviaremos por WhatsApp.';
                    initialModalMessage.style.display = 'block'; // Muestra el mensaje de éxito
                    showCustomMessageBox('¡Solicitud enviada! Espera el código por WhatsApp.', 'info');
                });

                accessButton.addEventListener('click', () => {
                    const enteredCode = uniqueCodeInput.value.trim();
                    console.log(`Intento de login: Código ingresado "${enteredCode}", Código correcto "${correctUniqueCode}"`);

                    if (enteredCode === correctUniqueCode) {
                        initialAccessModal.classList.remove('show');
                        console.log("Modal de acceso inicial oculto después de un inicio de sesión exitoso.");
                        showCustomMessageBox('¡Acceso concedido! Bienvenido.', 'success');
                        localStorage.setItem('hasAccessedBefore', 'true'); // Guarda el estado de acceso
                        uniqueCodeInput.value = '';
                    } else {
                        showCustomMessageBox('Código incorrecto. Inténtalo de nuevo.', 'error');
                        initialModalMessage.textContent = 'Código incorrecto. Inténtalo de nuevo.';
                        initialModalMessage.style.display = 'block'; // Muestra el mensaje de error
                    }
                });

                /*
                 * Manejadores de Eventos para el Modal de Acceso de Administrador.
                 * Gestiona la autenticación del administrador.
                 */
                adminLoginForm.addEventListener('submit', (event) => {
                    event.preventDefault();

                    const enteredAdminPassword = adminPasswordInput.value.trim();
                    console.log("Contraseña de Administrador Ingresada:", enteredAdminPassword);

                    if (enteredAdminPassword === adminPassword) {
                        isAdminLoggedIn = true; // Establece el estado de administrador a true
                        adminLoginModal.classList.remove('show');
                        adminLoginMessage.textContent = '';
                        adminLoginMessage.style.display = 'none'; // Oculta el mensaje
                        showCustomMessageBox('Acceso de administrador concedido.', 'success');
                        // Guarda el estado de "recordarme" del administrador en localStorage
                        if (rememberMeCheckbox.checked) {
                            localStorage.setItem('adminRemembered', 'true');
                        } else {
                            localStorage.removeItem('adminRemembered');
                        }
                    } else {
                        adminLoginMessage.textContent = 'Contraseña incorrecta.'; // Mensaje de error ajustado
                        adminLoginMessage.style.display = 'block'; // Muestra el mensaje de error
                        showCustomMessageBox('Contraseña de administrador incorrecta.', 'error'); // Mensaje de error ajustado
                    }
                });

                // Manejador para el enlace "¿Olvidaste tu contraseña?"
                forgotPasswordLink.addEventListener('click', (event) => {
                    event.preventDefault();
                    showCustomMessageBox('Por favor, contacta al administrador para restablecer tu contraseña.', 'info');
                });

                /*
                 * Manejador de Eventos para el Formulario de Actualización de Código (Panel de Admin).
                 * Actualiza el código único y reinicia el contador de expiración.
                 */
                updateCodeForm.addEventListener('submit', (event) => {
                    event.preventDefault();

                    const newCode = newUniqueCodeInput.value.trim();
                    if (newCode) {
                        correctUniqueCode = newCode;
                        localStorage.setItem('correctUniqueCode', newCode);
                        
                        lastCodeChangeTimestamp = Date.now(); // Reinicia el timestamp de cambio
                        localStorage.setItem('lastCodeChangeTimestamp', lastCodeChangeTimestamp.toString());

                        currentUniqueCodeDisplay.textContent = newCode;
                        showCustomMessageBox('Código único actualizado correctamente.', 'success');
                        console.log("Nuevo Código Único guardado:", newCode);
                        console.log("Nuevo Timestamp de Último Cambio de Código:", new Date(lastCodeChangeTimestamp));

                        forcedAdminUpdateModal.classList.remove('show');
                        adminPanelModal.classList.remove('show');
                        
                        // Fuerza a los usuarios a reautenticarse con el nuevo código
                        localStorage.removeItem('hasAccessedBefore');
                        initialAccessModal.classList.add('show');
                        showInitialAccessSection();
                    } else {
                        showCustomMessageBox('El nuevo código no puede estar vacío.', 'error');
                    }
                });

                /*
                 * Funcionalidad de Cierre de Modales.
                 * Permite cerrar los modales de login y panel de admin.
                 */
                adminPanelCloseButton.addEventListener('click', () => {
                    adminPanelModal.classList.remove('show');
                });

                // Cierra modales al hacer clic fuera de su contenido (excepto forced-admin-update-modal)
                initialAccessModal.addEventListener('click', (event) => {
                    if (event.target === initialAccessModal) {
                        initialAccessModal.classList.remove('show');
                    }
                });
                adminLoginModal.addEventListener('click', (event) => {
                    if (event.target === adminLoginModal) {
                        adminLoginModal.classList.remove('show');
                    }
                });
                adminPanelModal.addEventListener('click', (event) => {
                    if (event.target === adminPanelModal) {
                        adminPanelModal.classList.remove('show');
                    }
                });
                // forcedAdminUpdateModal no tiene listener para cerrar al hacer clic fuera


                /*
                 * handleModuleClick(): Maneja los clics en los elementos de los módulos.
                 * Redirige a URLs específicas o realiza acciones según el módulo.
                 */
                function handleModuleClick(moduleName) {
                    console.log(`Módulo "${moduleName}" clickeado.`);
                    showCustomMessageBox(`Abriendo ${moduleName}...`);

                    switch (moduleName) {
                        case 'Buscador de Direcciones':
                            window.open('https://visordirecciones2-production.up.railway.app/', '_blank');
                            break;
                        case 'Calculadora Boleta':
                            window.open('https://sites.google.com/view/ciclofacturacionwom/p%C3%A1gina-principal', '_blank');
                            break;
                        case 'Evaluar RUT':
                            window.open('https://www.wom.cl/paga-aqui/', '_blank');
                            break;
                        case 'Condiciones Comerciales':
                            window.open('https://drive.google.com/drive/folders/1RFC7V23aiver5fL8iN-lneFGNLY7Hvp2?usp=sharing', '_blank');
                            break;
                        case 'Factibilidad':
                            window.open('https://sso-ocp4-sr-amp.apps.sr-ocp.wom.cl/auth/realms/customer-care/protocol/openid-connect/auth?client_id=e7c0d592&redirect_uri=https%3A%2F%2Fcustomercareapplicationservice.ose.wom.cl%2Fwomac%2Flogin&state=aa82ac36-b14f-4897-83e5-62691ea6a514&response_mode=fragment&response_type=code&scope=openid&nonce=7c0f7a43-125c-4a36-8fa2-836724d0b4e5', '_blank');
                            break;
                        default:
                            console.log(`No hay URL definida para ${moduleName}`);
                            break;
                    }
                }

                /*
                 * handleIngresoVentaMainClick(): Maneja el clic en el botón principal "Ingreso de Venta".
                 * Abre una nueva ventana con la URL especificada.
                 */
                function handleIngresoVentaMainClick() {
                    console.log('Botón "Ingreso de Venta" principal clickeado.');
                    showCustomMessageBox('Abriendo formulario de ingreso de venta...');

                    const url = 'https://script.google.com/macros/s/AKfycbx9o-nk63thKqtbuu7LbqN6orvWqXPsvv-HL21jyfs/dev';

                    const width = 800;
                    const height = 600;
                    const left = (screen.width / 2) - (width / 2);
                    const top = (screen.height / 2) - (height / 2);

                    const features = `
                        width=${width},
                        height=${height},
                        left=${left},
                        top=${top},
                        toolbar=no,
                        location=no,
                        menubar=no,
                        scrollbars=yes,
                        resizable=yes
                    `;
                    window.open(url, '_blank', features);
                }

                /*
                 * handleWhatsAppContactClick(): Abre WhatsApp con un mensaje predefinido para el administrador.
                 */
                function handleWhatsAppContactClick() {
                    const url = `https://wa.me/${adminWhatsappNumber}?text=${encodeURIComponent(generalWhatsappMessage)}`;
                    window.open(url, '_blank');
                    showCustomMessageBox('Abriendo WhatsApp para contactar al administrador...');
                }

                /*
                 * handleDeployButtonClick(): Abre 7 URLs en nuevas pestañas.
                 */
                function handleDeployButtonClick() {
                    showCustomMessageBox('Desplegando herramientas...', 'info');

                    const urlsToOpen = [
                        'https://www.google.com/maps', // Buscador de Direcciones
                        'https://sites.google.com/view/ciclofacturacionwom/p%C3%Aágina-principal', // Calculadora Boleta
                        'https://www.wom.cl/paga-aqui/', // Evaluar RUT
                        'https://www.ejemplo.com/condiciones-comerciales', // Condiciones Comerciales
                        'https://www.ejemplo.com/factibilidad', // Factibilidad
                        'https://sites.google.com/view/ciclowom/p%C3%Aágina-principal', // Ingreso de Venta
                        'https://www.google.com' // Ejemplo adicional
                    ];

                    urlsToOpen.forEach(url => {
                        window.open(url, '_blank');
                    });
                }

                /*
                 * applyDockEffect(): Aplica el efecto de magnificación "fisheye" a los ítems del dock
                 * basado en su proximidad al centro de la barra de navegación.
                 */
                function applyDockEffect() {
                    console.log("applyDockEffect ejecutado."); // Para depuración: confirma que la función se está llamando
                    const navBarRect = navBar.getBoundingClientRect();
                    const navBarCenter = navBarRect.left + navBarRect.width / 2;
                    const maxDistanceEffect = navBarRect.width / 2.5; 

                    navItems.forEach(item => {
                        const icon = item.querySelector('i');
                        const textSpan = item.querySelector('span');
                        const itemRect = item.getBoundingClientRect();
                        const itemCenter = itemRect.left + itemRect.width / 2;

                        const distance = Math.abs(navBarCenter - itemCenter);
                        let scale = 1;
                        let textOpacity = 0;
                        let textTranslateY = -20; 
                        let textScale = 0.9; 

                        if (item.classList.contains('active')) {
                            scale = 1.5; 
                            textOpacity = 1;
                            textTranslateY = -60; 
                            textScale = 1; 
                        } else if (distance < maxDistanceEffect) {
                            const normalizedDistance = distance / maxDistanceEffect; 
                            scale = 1 + (0.5 * (1 - normalizedDistance * normalizedDistance)); 
                            
                            textOpacity = 1 - normalizedDistance; 
                            textTranslateY = -45 - (scale - 1) * 30; 
                            textScale = 0.9 + (0.1 * (1 - normalizedDistance)); 
                            
                        } else {
                            scale = 1;
                            textOpacity = 0;
                            textTranslateY = -20;
                            textScale = 0.9;
                        }

                        icon.style.transform = `scale(${scale})`;
                        textSpan.style.opacity = textOpacity;
                        textSpan.style.transform = `translateY(${textTranslateY}px) scale(${textScale})`;
                    });
                }

                // Debounce para la función de actualización del ítem centrado
                let scrollTimeout;
                navBar.addEventListener('scroll', () => {
                    clearTimeout(scrollTimeout);
                    scrollTimeout = setTimeout(applyDockEffect, 50); 
                });

                // Llama a applyDockEffect al redimensionar la ventana para ajustar los efectos
                window.addEventListener('resize', applyDockEffect);

                /*
                 * handleNavItemClick(): Maneja los clics en los elementos de la barra de navegación.
                 * Desplaza el ítem clicado al centro y actualiza el estado activo.
                 * Incluye verificación de acceso de administrador.
                 */
                function handleNavItemClick(event) {
                    const clickedItem = event.currentTarget;
                    const isAdminRequired = clickedItem.dataset.adminRequired === 'true';
                    const navId = clickedItem.id;

                    if (isAdminRequired && !isAdminLoggedIn) {
                        showCustomMessageBox('Acceso denegado. Se requiere acceso de administrador.', 'error');
                        adminLoginModal.classList.add('show'); 
                        adminPasswordInput.value = ''; 
                        adminLoginMessage.textContent = ''; 
                        rememberMeCheckbox.checked = false; 
                        return; 
                    }

                    navItems.forEach(item => {
                        item.classList.remove('active');
                    });
                    clickedItem.classList.add('active');
                    
                    clickedItem.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });

                    setTimeout(applyDockEffect, 300); 

                    console.log(`Ítem de navegación "${navId}" clickeado.`);

                    switch (navId) {
                        case 'nav-home':
                            showCustomMessageBox('Navegando a Inicio...');
                            break;
                        case 'nav-contact':
                            showCustomMessageBox('Navegando a Contacto...');
                            handleWhatsAppContactClick();
                            break;
                        case 'nav-add':
                            showCustomMessageBox('Navegando a Añadir...');
                            break;
                        case 'nav-profile':
                            showCustomMessageBox('Navegando a Perfil...');
                            break;
                        case 'nav-admin':
                            showCustomMessageBox('Abriendo Panel de Administrador...');
                            adminPanelModal.classList.add('show'); 
                            currentUniqueCodeDisplay.textContent = correctUniqueCode; 
                            newUniqueCodeInput.value = correctUniqueCode; 
                            break;
                        case 'nav-reports':
                            showCustomMessageBox('Navegando a Reportes...');
                            break;
                        case 'nav-settings':
                            showCustomMessageBox('Navegando a Configuración...');
                            break;
                        case 'nav-messages':
                            showCustomMessageBox('Navegando a Mensajes...');
                            break;
                        case 'nav-calendar':
                            showCustomMessageBox('Navegando a Calendario...');
                            break;
                        case 'nav-docs':
                            showCustomMessageBox('Navegando a Documentos...');
                            break;
                        default:
                            break;
                    }
                }

                // Asignación de Event Listeners a los elementos interactivos
                moduleDirecciones.addEventListener('click', () => handleModuleClick('Buscador de Direcciones'));
                moduleCalculadora.addEventListener('click', () => handleModuleClick('Calculadora Boleta'));
                moduleEvaluarRut.addEventListener('click', () => handleModuleClick('Evaluar RUT'));
                moduleCondicionesComerciales.addEventListener('click', () => handleModuleClick('Condiciones Comerciales'));
                moduleFactibilidad.addEventListener('click', () => handleModuleClick('Factibilidad'));

                btnIngresoVentaMain.addEventListener('click', handleIngresoVentaMainClick);
                floatingDeployButton.addEventListener('click', handleDeployButtonClick); 

                navItems.forEach(item => {
                    item.addEventListener('click', handleNavItemClick);
                });

                // Inicializa la aplicación (ahora se llama directamente sin google.script.run)
                initializeApp();

                /*
                 * showCustomMessageBox(): Función para mostrar mensajes personalizados (reemplazo de alert()).
                 * Proporciona retroalimentación no intrusiva al usuario.
                 */
                function showCustomMessageBox(message, type = 'success') {
                    let msgBox = document.getElementById('custom-message-box');
                    if (!msgBox) {
                        msgBox = document.createElement('div');
                        msgBox.id = 'custom-message-box';
                        document.body.appendChild(msgBox);
                    }

                    const rootStyles = getComputedStyle(document.documentElement);
                    const successColor = rootStyles.getPropertyValue('--message-box-success').trim();
                    const errorColor = rootStyles.getPropertyValue('--message-box-error').trim();
                    const infoColor = rootStyles.getPropertyValue('--message-box-info').trim();

                    if (type === 'success') {
                        msgBox.style.backgroundColor = successColor;
                    } else if (type === 'error') {
                        msgBox.style.backgroundColor = errorColor;
                    } else {
                        msgBox.style.backgroundColor = infoColor;
                    }

                    msgBox.textContent = message;
                    setTimeout(() => {
                        msgBox.style.opacity = '1';
                        msgBox.style.transform = 'translateY(0)';
                    }, 10);

                    setTimeout(() => {
                        msgBox.style.opacity = '0';
                        msgBox.style.transform = 'translateY(-20px)';
                        msgBox.addEventListener('transitionend', function handler() {
                            if (msgBox.style.opacity === '0') {
                                msgBox.remove();
                            }
                            msgBox.removeEventListener('transitionend', handler);
                        });
                    }, 3000);
                }

                console.log('Scripts cargados y listeners de eventos adjuntos.');
            } catch (error) {
                console.error("Error crítico en la inicialización de la aplicación:", error);
                // Muestra un mensaje de error si algo sale mal durante la carga de la aplicación.
                let errorMsgBox = document.createElement('div');
                errorMsgBox.id = 'critical-error-message';
                errorMsgBox.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background-color: #F44336; /* Rojo de error */
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    box-shadow: 0 0 15px rgba(0,0,0,0.5);
                    z-index: 9999;
                    text-align: center;
                    font-family: 'Inter', sans-serif;
                    font-size: 1.2em;
                `;
                errorMsgBox.textContent = `Error al cargar la aplicación: ${error.message}. Por favor, recarga la página.`;
                document.body.appendChild(errorMsgBox);
            }
        }); // Cierre de DOMContentLoaded
    </script>
</body>
</html>
